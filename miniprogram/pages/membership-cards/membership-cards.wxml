<navigation-bar
  title="ä¼šå‘˜å¡ç®¡ç†"
  back="{{true}}"
  color="black"
  background="#FFF"
>
  <view slot="right" class="nav-btns">
    <view
      bindtap="showAddCard"
      class="nav-btn"
      aria-role="button"
      aria-label="æ–°å¢ä¼šå‘˜å¡"
    >
      <text class="nav-btn-text">æ–°å¢ä¼šå‘˜å¡</text>
    </view>
  </view>
</navigation-bar>
<view class="cards-page">
  <view class="card-list">
    <view
      wx:for="{{cardList}}"
      wx:key="id"
      class="card-item {{item.status === 'disabled' ? 'disabled' : ''}}"
      data-card="{{item}}"
    >
      <view class="card-header">
        <view class="card-info">
          <view class="card-name">{{item.name}}</view>
          <view class="card-meta">
            <view class="meta-item">
              <text class="meta-label">é¡¹ç›®:</text>
              <text>{{item.project}}</text>
            </view>
          </view>
        </view>
        <view class="card-status {{item.status === 'active' ? 'active' : 'disabled'}}">{{item.status === 'active' ? 'å¯ç”¨' : 'ç¦ç”¨'}}</view>
      </view>
      <view class="card-body">
        <view class="card-row">
          <text class="card-label">åŸä»·:</text>
          <text class="card-value">Â¥{{item.originalPrice}}</text>
        </view>
        <view class="card-row">
          <text class="card-label">æ¬¡æ•°:</text>
          <text class="card-value remaining">{{item.totalTimes}}</text>
        </view>
      </view>
      <view class="card-actions">
        <view
          class="action-btn toggle"
          catch:tap="toggleCardStatus"
          data-card="{{item}}"
        >
          {{item.status === 'active' ? 'ç¦ç”¨' : 'å¯ç”¨'}}
        </view>
        <view
          class="action-btn edit"
          catch:tap="showEditCard"
          data-card="{{item}}"
        >
          ç¼–è¾‘
        </view>
        <view
          class="action-btn delete"
          catch:tap="deleteCard"
          data-card="{{item}}"
        >
          åˆ é™¤
        </view>
      </view>
    </view>
  </view>
  <view wx:if="{{cardList.length === 0}}" class="empty-state">
    <view class="empty-icon">ğŸ’³</view>
    <view class="empty-text">æš‚æ— ä¼šå‘˜å¡è®°å½•</view>
  </view>
</view>
<view
  class="modal-mask"
  wx:if="{{showEditModal}}"
  bindtap="onModalCancel"
>
</view>
<view class="modal-container" wx:if="{{showEditModal}}">
  <view class="modal-title">{{modalTitle}}</view>
  <view class="form-group">
    <text class="form-label">ä¼šå‘˜å¡åç§°</text>
    <input
      class="form-input"
      type="text"
      placeholder="è¯·è¾“å…¥ä¼šå‘˜å¡åç§°"
      bindinput="onNameInput"
      value="{{formName}}" />
  </view>
  <view class="form-group">
    <text class="form-label">åŸä»·</text>
    <input
      class="form-input"
      type="digit"
      placeholder="è¯·è¾“å…¥åŸä»·"
      bindinput="onOriginalPriceInput"
      value="{{formOriginalPrice}}" />
  </view>
  <view class="form-group">
    <text class="form-label">æ¬¡æ•°</text>
    <input
      class="form-input"
      type="number"
      placeholder="è¯·è¾“å…¥æ¬¡æ•°"
      bindinput="onRemainingTimesInput"
      value="{{formRemainingTimes}}" />
  </view>
  <view class="form-group">
    <text class="form-label">å…³è”é¡¹ç›®</text>
    <project-selector selectedProject="{{formProject}}" bind:change="onProjectSelect" />
  </view>
  <view class="modal-footer">
    <view class="modal-btn cancel-btn" bindtap="onModalCancel">å–æ¶ˆ</view>
    <view class="modal-btn confirm-btn" bindtap="onModalConfirm">ç¡®å®š</view>
  </view>
</view>
